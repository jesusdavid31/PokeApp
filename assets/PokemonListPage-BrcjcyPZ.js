import{u as w,r as f,j as e,B as o,T,L as E}from"./index-J_bW_MAS.js";import{u as b,t as S,G as j,A,m as P,S as $,B as I}from"./proxy-Bw44M2RZ.js";import{S as N,A as B,f as D,b as C}from"./blur-BT1KR2t4.js";const F=()=>{const{setPokemon:l,setTotalPokemon:n,setLoading:r}=b(),c={id:"Error al cargar sus datos",name:"",img:"",weight:"Error al cargar sus datos",height:"Error al cargar sus datos",type:"Error al cargar sus datos",color:"normal"};return{getPokemons:async i=>{if(i<1){console.warn("Ya estás en la primera página.");return}const m=10,h=(i-1)*m;try{r(!0);const p=await(await fetch(`https://pokeapi.co/api/v2/pokemon?limit=${m}&offset=${h}`)).json(),x=await Promise.all(p.results.map(async a=>{const s=await fetch(a.url);if(!s.ok)return c.name=a.name.charAt(0).toUpperCase()+a.name.slice(1),c;const t=await s.json(),g=t.types.map(L=>L.type.name),k=g[0];let y=S[k]||"normal";return y==="normal"&&g.length>1&&(y=g[1]),{id:`#${t.id.toString().padStart(3,"0")}`,name:t.name.charAt(0).toUpperCase()+t.name.slice(1),img:t.sprites.front_default,weight:`${(t.weight/10).toFixed(1)} kg`,height:`${(t.height/10).toFixed(1)} m`,type:g.join(" / "),color:y}}));n(p.count),l(x),r(!1)}catch(d){N.fire("Error",d,"error")}}}},M=[{id:"id",label:"ID"},{id:"name",label:"Nombre"},{id:"img",label:"Imagen"},{id:"weight",label:"Peso"},{id:"height",label:"Altura"},{id:"type",label:"Tipo"},{id:"actions",label:"Acciones"}],H=()=>{const{getPokemons:l}=F(),{loading:n,setLoading:r,pokemon:c,totalPokemon:u}=b(),{page:i,setPage:m}=w(),[h,d]=f.useState([]),p=(a,s)=>{if(s===i)return;m(s),r(!0);const t=setTimeout(()=>{l(s)},900);return()=>{clearTimeout(t)}},x=a=>{const s=a.map(t=>({...t,img:e.jsx(e.Fragment,{children:t.img?e.jsx(o,{sx:{display:"flex",gap:"5px"},className:"circle-bg",children:e.jsx(C.LazyLoadImage,{src:t.img,alt:`Imagen de ${t.name}`,width:"80",height:"80",effect:"blur",threshold:150})}):e.jsx(o,{sx:{display:"flex",gap:"5px"},children:"Sin imagen"})}),type:e.jsx(o,{sx:{display:"flex",gap:"5px"},children:D(t.type)}),actions:e.jsx(e.Fragment,{children:e.jsx(E,{to:`/pokemon/${t.name}`,className:"animated-button",children:e.jsx(B,{text:"Ver detalles",icon:e.jsx("path",{d:"M16.1716 10.9999L10.8076 5.63589L12.2218 4.22168L20 11.9999L12.2218 19.778L10.8076 18.3638L16.1716 12.9999H4V10.9999H16.1716Z"})})})})}));d(s)};return f.useEffect(()=>{r(!0);const a=setTimeout(()=>{l(i)},800);return()=>{clearTimeout(a)}},[]),f.useEffect(()=>{x(c)},[n]),e.jsx(o,{className:"pokemon-list-page-container",children:e.jsx(j,{container:!0,spacing:3,children:e.jsxs(j,{size:{xs:12,md:12,lg:12},children:[e.jsx(o,{className:"title-container",children:e.jsx(T,{variant:"h4",children:"Lista de Pokémon"})}),e.jsx(A,{mode:"wait",children:n?e.jsx(P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},children:e.jsx($,{})},"skeleton"):e.jsx(P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.4},children:e.jsx(o,{className:"table-container",children:e.jsx(I,{isLoading:n,columns:M,currentData:h,actualPage:i,handlePageClick:p,totalPages:Math.ceil(u/10),itemsPerPage:10,totalItems:u})})},`table-page-${i}`)})]})})})};export{H as default};
