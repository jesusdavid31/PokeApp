import{a as $,b as z,r as g,u as B,j as e,B as l,T as C,L as D}from"./index-J_bW_MAS.js";import{u as E,t as v,G as L,A as F,m as T,S as _,B as U}from"./proxy-Bw44M2RZ.js";import{S as w,A as H,f as O,b as V}from"./blur-BT1KR2t4.js";const q=s=>`https://pokeapi.co/api/v2/pokemon/${s}`;function R(){const{generation:s}=$(),{generations:x}=z(),{setPokemon:m,setLoading:n,setTotalPokemon:p}=E(),[f,u]=g.useState(1),i={id:"Error al cargar sus datos",name:"",img:"",weight:"Error al cargar sus datos",height:"Error al cargar sus datos",type:"Error al cargar sus datos",color:"normal"},y=g.useCallback(async P=>{const r=x.find(c=>c.name===s);if(!r){w.fire({icon:"error",title:"Oops...",text:"No se encontró la generación solicitada."}),n(!1);return}u(r.id),n(!0);try{const j=Math.max(1,Math.ceil(r.pokemon.length/10)),o=(Math.min(Math.max(P,1),j)-1)*10,t=o+10,I=r.pokemon.slice(o,t).map(async k=>{const S=await fetch(q(k.name));if(!S.ok)return i.name=k.name.charAt(0).toUpperCase()+k.name.slice(1),i;const a=await S.json(),h=a.types.map(M=>M.type.name),N=h[0];let b=v[N]||"normal";b==="normal"&&h.length>1&&(b=h[1]);const G=a?.sprites?.other?.["official-artwork"]?.front_default??a?.sprites?.other?.home?.front_default??a?.sprites?.front_default??null;return{id:`#${a.id.toString().padStart(3,"0")}`,name:a.name.charAt(0).toUpperCase()+a.name.slice(1),img:G,weight:`${(a.weight/10).toFixed(1)} kg`,height:`${(a.height/10).toFixed(1)} m`,type:h.join(" / "),color:b}}),A=await Promise.all(I);p(r.pokemon.length),m(A)}catch(c){w.fire({icon:"error",title:"Oops...",text:c instanceof Error?c.message:"No se encontraron todos los Pokémons para la generación seleccionada. Por favor, intenta de nuevo."}),m([])}finally{n(!1)}},[s]);return{generationIdentifier:f,generation:s,loadGeneration:y}}const Z=[{id:"id",label:"ID"},{id:"name",label:"Nombre"},{id:"img",label:"Imagen"},{id:"weight",label:"Peso"},{id:"height",label:"Altura"},{id:"type",label:"Tipo"},{id:"actions",label:"Acciones"}],Y=()=>{const{generationIdentifier:s,generation:x,loadGeneration:m}=R(),{loading:n,setLoading:p,pokemon:f,totalPokemon:u}=E(),{page:i,setPage:y}=B(),[P,r]=g.useState([]),c=(d,o)=>{if(o===i)return;y(o),p(!0);const t=setTimeout(()=>{m(o)},900);return()=>{clearTimeout(t)}},j=d=>{const o=d.map(t=>({...t,img:e.jsx(e.Fragment,{children:t.img?e.jsx(l,{sx:{display:"flex",gap:"5px"},className:"circle-bg",children:e.jsx(V.LazyLoadImage,{src:t.img,alt:`Imagen de ${t.name}`,width:"80",height:"80",effect:"blur",threshold:150})}):e.jsx(l,{sx:{display:"flex",gap:"5px"},children:"Sin imagen"})}),type:e.jsx(l,{sx:{display:"flex",gap:"5px"},children:O(t.type)}),actions:e.jsx(e.Fragment,{children:e.jsx(D,{to:`/pokemon/${t.name}`,className:"animated-button",children:e.jsx(H,{text:"Ver detalles",icon:e.jsx("path",{d:"M16.1716 10.9999L10.8076 5.63589L12.2218 4.22168L20 11.9999L12.2218 19.778L10.8076 18.3638L16.1716 12.9999H4V10.9999H16.1716Z"})})})})}));r(o)};return g.useEffect(()=>{p(!0);const d=setTimeout(()=>{m(i)},1e3);return()=>{clearTimeout(d)}},[x]),g.useEffect(()=>{j(f)},[n]),e.jsx(l,{className:"pokemon-generations-page-container",children:e.jsx(L,{container:!0,spacing:3,children:e.jsxs(L,{size:{xs:12,md:12,lg:12},children:[!n&&e.jsx(l,{className:"title-container",children:e.jsxs(C,{variant:"h4",children:["Lista de Pokémon de la generación ",s]})}),e.jsx(F,{mode:"wait",children:n?e.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5},children:e.jsx(_,{})},"skeleton"):e.jsx(T.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.5},children:e.jsx(l,{className:"table-container",children:e.jsx(U,{isLoading:n,columns:Z,currentData:P,actualPage:i,handlePageClick:c,totalPages:Math.ceil(u/10),itemsPerPage:10,totalItems:u})})},`table-page-${i}`)})]})})})};export{Y as default};
